% glucose concentration sequence
% diabetes
%G = [349, 286, 296, 273, 276, 294, 285, 240, 296, 325, 332, 252, 265, ...
%    201, 224, 215, 169, 140, 135];
%G = [208 190 212 95 143 130 149 143 173 197 188 192 151 269 96 290 265 246 178 265 131 133 100 131 78 145 191 230 225 172 177 150 214 116 220 160 142 128]; % 51
%G = [285 138 107 111 164 119 132 141 152 138 104 110 103 101 94 137 141 133 140 154 170 184 128 108 117 98 97]; % 49
%G = [170 184 128 108 117 98 97]
%G = [121 121 91 91 91 91 96 116 116 106 106 124 106 106]
%G = [139 139 128 128 134 134 109 109 101 101 83 83 110 110 95 95 91 91 96 96 101 ]
%G = [101 102 102 98 98 106 106 104 104 109 109 102 102 115 115 115 115 125 125 ]
%G = [119 111 111 127 127 121 121 115 84 84 100 100 96 96 118 118 109 109 121 121]
%G = [104 126 126 118 118 116 116 154 154 124 124 122 122 111 104 104 97 97 132 132]
G = [351 310 310 365 341 292 244 262 262 208 162 137 125 125 116 130 198 190 149 ]
% normal non-diabetes
%G = 100+10*randn(20, 1);
% average
AG = mean(G)
H = (AG + 46.7)/28.7
% rate
v = 20/(250*120);
res_set = zeros(100,1);
for M = 1:100
    res = 0;
    for i = 0:2*M-1
        res = res + v*get_glucose(G,i)*(1-i/(2*M));
    end
    res_set(M) = res;
end
disp('w bias')
[Y,I1] = min(abs(res_set-(H-1.627)))
disp('w/o bias')
[Y,I2] = min(abs(res_set-H))
sprintf('%.2f & %.1f & %d & %d', AG, H, I1, I2)

res = [49 51 49 48 51 50 53 52 52 48]
std(res)
mean(res)
res = [58 65 67 65 74 72 75 74 73 59]
std(res)